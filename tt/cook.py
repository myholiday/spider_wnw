#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by spider3 on 2018/4/13# Copyright (c) 2018 spider3. All rights reserved.import timeimport jsonfrom selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.support.ui import WebDriverWaitfrom selenium.webdriver.support import expected_conditions as ECdef assign_weibo(driver):    account = '13071686002'    password = 'trump666666'    driver.get('https://passport.weibo.cn/signin/login')    try:        element = WebDriverWait(driver, 15).until(            EC.presence_of_element_located((By.ID, "loginWrapper"))        )        print('读取登录页完成')        time.sleep(1)    except Exception as e:        print(e)    driver.find_element_by_xpath('//*[@id="loginName"]').send_keys(account)    driver.find_element_by_xpath('//*[@id="loginPassword"]').send_keys(password)    driver.find_element_by_xpath('//*[@id="loginAction"]').click()    time.sleep(1)  # 等待yzm    # 验证码    while "login" in driver.current_url:        print("手动输入验证码！")        time.sleep(3)    dict_cookies = driver.get_cookies()    json_cookies = json.dumps(dict_cookies)    time.sleep(2)    with open("./cookies.json","w") as f:        f.write(json_cookies)def sent_message(driver):    driver.get('https://weibo.cn/')    time.sleep(3)    driver.delete_all_cookies()    # 读取cookies    with open("./cookies.json", "r") as f:        list_cookies = json.loads(f.read())    for cookie in list_cookies:        driver.add_cookie(cookie)    driver.get('https://weibo.cn/')    current_url = driver.current_url    while "Donald-J-Trum" not in driver.page_source:  # without login, then login        assign_weibo(driver)        driver.get('https://weibo.cn/')        time.sleep(2)    print("成功")    raise enumeratedef main():    driver = webdriver.Chrome()    # assign_weibo(driver)    sent_message(driver)if __name__ == '__main__':    main()