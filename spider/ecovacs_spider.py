#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by spider3 on 2018/3/30# Copyright (c) 2018 spider3. All rights reserved."""科沃斯""""""http://www.ecovacs.cn/network"""import requestsimport jsonfrom lxml import etreeimport redef get_data(number):    url = "http://www.ecovacs.cn/network/network-{}.html".format(number)    response = requests.get(url)    html = etree.HTML(response.text)    try:        tmp = {}        tmp['name'] = html.xpath('//div[@class="addr-detail"]/div[1]/text()')[0]        try:            tmp['address'], tmp['phone_number'] = html.xpath('//div[@class="addr-detail"]/div[2]/text()')            tmp['address'], tmp['phone_number'] = tmp['address'].split("：")[-1].strip(), tmp['phone_number'].split("：")[                -1].strip()            tmp['longitude'], tmp['latitude'] = re.findall('"lng":"(.*?)","lat":"(.*?)",', response.text)[0]        except Exception as e:            print(e)            tmp['address'],_, tmp['phone_number'] = html.xpath('//div[@class="addr-detail"]/div[2]/text()')            tmp['address'], tmp['phone_number'] = tmp['address'].split("：")[-1].strip(), tmp['phone_number'].split("：")[                -1].strip()            tmp['longitude'], tmp['latitude'] = re.findall('"lng":"(.*?)","lat":"(.*?)",', response.text)[0]        print(tmp)        return tmp    except:        print(number)def spider():    li = []    for number in range(1, 110):        one_data = get_data(number)        if one_data:            li.append(one_data)    try:        with open('../data/ecovacs.json', 'w') as f:            f.write(json.dumps(li, ensure_ascii=False))    except:        with open('../data/ecovacs.json', 'w') as f:            f.write(json.dumps(li, ensure_ascii=True))def main():    spider()if __name__ == '__main__':    main()