#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by spider3 on 2018/3/16# Copyright (c) 2018 spider3. All rights reserved."""简一"""import json"""http://www.gani.com.cn/warranty.php"""import requestsfrom lxml import etreefrom utils.add_detail import add_detaildef get_province():    # 获得省信息    url = 'http://www.gani.com.cn/warranty.php'    response = requests.get(url)    html = etree.HTML(response.content.decode())    provinces = html.xpath('//select[@id="province"]/option/text()')    return provinces[1:]def get_data(province):    li = []    url = 'http://www.gani.com.cn/getStore.php'    data = {'action': 'province', 'province': province}    response = requests.post(url, data)    response = eval(response.content.decode())    messages = zip(response['name'], response['address'], response['phone'], response['jing'], response['wei'])  # 将所有数据压缩    for message in messages:        tmp = {}        tmp['name'] = message[0]        tmp['address'] = message[1]        tmp['phone_number'] = message[2]        tmp['longitude'] = message[3]        tmp['latitude'] = message[4]        print(tmp)        li.append(tmp)    return lidef spider():    li = []    provinces = get_province()    for province in provinces:        messages = get_data(province)        li += messages    with open('../data/gani.json', 'w') as f:        f.write(json.dumps(li, ensure_ascii=False))def save():    add_detail(111838, 2100, '../data/gani.json', '../data/gani_detail.json')def main():    spider()    # save()if __name__ == '__main__':    main()