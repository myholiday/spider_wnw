#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by spider3 on 2018/3/16# Copyright (c) 2018 spider3. All rights reserved."""箭牌瓷砖"""import jsonimport copyimport requestsfrom lxml import etreefrom utils.add_detail import add_detaildef spider():    li = []  # 储存所有数据    url = 'http://www.arrowceramic.com/network.html'    city_info = [{"n":"广东省","c":["深圳","东莞","韶关南雄","电白","惠州","广州","珠海","汕头"]},{"n":"陕西省","c":["商洛市","渭南市","铜川市","咸阳","商州市","镇安","周至县","岐山县","安康","锡林浩特","汉中佳美","镇巴县","西安市"]},{"n":"河北省","c":["香河","沧州市","天津","秦皇岛","张家口","邢台","邯郸","保定","廊坊","石家庄"]},{"n":"江苏省","c":["句容市","常州","无锡","南京","扬州","苏州","淮安","南通","泗阳","徐州"]},{"n":"贵州","c":["余庆","贵阳"]},{"n":"山东省","c":["聊城","淄博","烟台市","蓬莱市","东营","滨州市","诸城市","枣庄市","泰安市","威海市","临沂市","日照市","青岛","济南","山东潍坊","济宁市"]},{"n":"甘肃省","c":["嘉峪关市","酒泉","甘肃临洮","庆阳","兰州"]},{"n":"江西省","c":["赣州瑞金市","宜春市","萍乡","南昌市","景德镇市","上饶市","丰城市","抚州市","九江市","都昌县","吉安市"]},{"n":"福建省","c":["龙岩","南平","武夷山","厦门","福州","泉州"]},{"n":"安徽省","c":["望江","临泉","太和","桐城","黄山","宿松","东至","芜湖","蚌埠","淮南市","阜阳","亳州市","巢湖庐江","芜湖市","马鞍山","安庆","池州","宣城","怀宁","合肥市"]},{"n":"山西省","c":["太原","吕梁","孝义","大同","原平","襄汾","阳泉","介休","晋中","运城","侯马","长治"]},{"n":"辽宁省","c":["沈阳","抚顺","丹东","鞍山","通辽","赤峰","大连"]},{"n":"河南省","c":["洛阳","郑州","焦作","济源","安阳","开封","新乡","濮阳","鹤壁","商丘","信阳","罗山","周口","禹州","漯河","南阳","许昌","平顶山"]},{"n":"新疆自治区","c":["库尔勒","乌鲁木齐","伊宁"]},{"n":"宁夏自治区","c":["宁夏盐池","银川"]},{"n":"黑龙江省","c":["佳木斯市","绥化市","宁安市","密山","大庆市","同江","肇州县","哈尔滨市"]},{"n":"吉林省","c":["吉林","延吉","松原"]},{"n":"北京","c":["北京市"]},{"n":"重庆","c":["重庆"]},{"n":"四川省","c":["广安","营山","西昌","绵阳","宜宾","达县","南充","乐山","金沙","崇州","资阳","大邑","内江","龙泉","巴中市","成都"]},{"n":"云南省","c":["得胜","昆明腾冲","桐梓","遵义","关岭","凤岗","芒市","泸西","蒙自","江川","昆明"]},{"n":"浙江省","c":["上海","杭州","宁波","台州","金华","永康"]},{"n":"湖南省","c":["长沙","常德","衡阳","益阳","浏阳","怀化","怀化 会同","怀化 溆浦","怀化 安江","永州","张家界","岳阳","邵东"]},{"n":"湖北省","c":["武汉","大冶","崇阳","随州","潜江","襄阳","荆州","十堰","宜昌"]},{"n":"广西省","c":["贺州","河池","防城港","桂林","北海","柳州"]},{"n":"海南省","c":["海口"]},{"n":"内蒙古","c":["呼伦贝尔","临河","乌海"]}]    for citys in city_info:        for city in citys["c"]:            tmp = {}            data = {'city':city}            response = requests.get(url,data)            html = etree.HTML(response.text)            nodes = html.xpath('//div[@class="gun_div"]/div')            for node in nodes:                tmp['name'] = node.xpath('./div[1]/a/b/text()')[0].strip()                try:  # 没有地址时                    tmp['address'] = node.xpath('./div[3]/text()')[0].strip()                except Exception as e:                    tmp['address'] = ''                try:  # 没有电话号码时                    tmp['phone_number'] = node.xpath('./div[2]/text()')[0].strip()                except:                    tmp['phone_number'] = 0                print(tmp, city)                li.append(copy.deepcopy(tmp))    with open('../data/arrowceramic.json','w') as f:        f.write(json.dumps(li))def save():    add_detail(111326, 473, "../data/arrowceramic.json", "../data/arrowceramic_detail.json")def main():    spider()    save()if __name__ == '__main__':    main()