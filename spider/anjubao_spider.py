#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by spider3 on 2018/3/30# Copyright (c) 2018 spider3. All rights reserved."""安居宝""""""http://www.anjubao.com/about_us.html?getAboutUs=6&html_id=2&sed_no=2"""import requestsimport jsonimport refrom utils.add_detail import add_detaildef spider():    url = 'http://www.anjubao.com/js/about_us_data.js'    response = requests.get(url)    string = re.findall(r'销售服务网点","type":3,"item":(.*?)},{"name":"售后服务网点"', response.text)[0]    data = json.loads(string)    for one_data in data:        one_data['city'] = one_data['name']        one_data['name'] = one_data['content'][0]['company']        one_data['address'] = one_data['content'][0]['address']        one_data['phone_number'] = ",".join([one_data['content'][0]['phone'], one_data['content'][0]['tel']]).strip(',')        one_data.pop('content')        print(one_data)    try:        with open('../data/anjubao.json', 'w') as f:            f.write(json.dumps(data, ensure_ascii=False))    except:        with open('../data/anjubao.json', 'w') as f:            f.write(json.dumps(data, ensure_ascii=True))def save():    add_detail(158502, 166, "../data/anjubao.json", '../data/anjubao_detail.json')def main():    # spider()    save()if __name__ == '__main__':    main()